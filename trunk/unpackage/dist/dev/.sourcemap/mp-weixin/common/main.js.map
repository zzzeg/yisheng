{"version":3,"sources":["webpack:///E:/yisheng/trunk/main.js","webpack:///E:/yisheng/trunk/App.vue?8c87","webpack:///E:/yisheng/trunk/App.vue?d2c4","webpack:///E:/yisheng/trunk/App.vue?f52e","webpack:///E:/yisheng/trunk/App.vue"],"names":["WebIM","require","conn","closed","curOpenOpt","open","opt","this","reopen","Vue","prototype","$im","$conn","$api","api","$store","store","$util","util","config","productionTip","App","mpType","app","$mount","render","staticRenderFns","components","renderjs","component","options","__file","msgStorage","msgType","disp","WxIM","wx","emedia","globalData","pageUrl","scene","showIndex","param","testCode","onLaunch","console","log","query","decodeURIComponent","listen","onOpened","message","onReconnect","onSocketConnected","onClosed","userinfo","uni","getStorageSync","emchatLogin","userId","onInviteMessage","$options","saveGroupInvitedList","push","fire","onPresence","onRoster","onVideoMessage","saveReceiveMsg","VIDEO","onAudioMessage","onMessageError","AUDIO","onCmdMessage","CMD","onTextMessage","TEXT","onEmojiMessage","EMOJI","onPictureMessage","IMAGE","onFileMessage","FILE","onError","error","type","statusCode","WEBIM_CONNCTION_DISCONNECTED","WEBIM_CONNCTION_SERVER_ERROR","WEBIM_CONNCTION_OPEN_ERROR","WEBIM_CONNCTION_AUTH_ERROR","showToast","title","icon","duration","autoReconnectNumTotal","autoReconnectNumMax","uncheckedPath","action","path","checkPath","find","indexOf","search","_self","checkSession","success","wxlogin","fail","onShow","livePlayer","requirePlugin","getShareParams","then","res","room_id","openid","share_openid","custom_params","communityId","catch","err","onHide","methods","login","provider","loginRes","obj","code","getUnionid","data","session_key","setStorageSync","unionid","checkAuth","getUserInfo","getAccount","reLaunch","url","sessionKey","getTempAccount","aes","status","sessionId","findUser","userRes","id","encryptedData","iv","getAccountInfo","accountRes","bnUserInfo","wxUserInfo","phone","avatarPath","removeStorageSync","userObj","findUserById","userInfo","qu","index","key","getApp","getCurrentRoute","navigateTo","followCommunityId","length","userid","pwd","substring","apiUrl","apiURL","user","grant_type","appKey","appkey","pages","getCurrentPages","currentPage","route","onMessage","errorText"],"mappings":"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","file":"common/main.js","sourcesContent":["import 'uni-pages';import Vue from 'vue'\r\nimport App from './App'\r\nimport api from 'common/api.js'\r\nimport store from './store/store.js'  \r\nimport util from 'common/util.js'  \r\nlet WebIM = require(\"./components/easemob/utils/WebIM\")[\"default\"];\r\n\r\nlet conn = {\r\n\tclosed: false,\r\n\tcurOpenOpt: {},\r\n\topen(opt) {\r\n\t\tthis.curOpenOpt = opt;\r\n\t\tWebIM.conn.open(opt);\r\n\t\tthis.closed = false;\r\n\t},\r\n\treopen() {\r\n\t\tif (this.closed) {\r\n\t\t\t//this.open(this.curOpenOpt);\r\n\t\t\tWebIM.conn.open(this.curOpenOpt);\r\n\t\t\tthis.closed = false;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nVue.prototype.$im = WebIM;\r\nVue.prototype.$conn = conn;\r\nVue.prototype.$api = api;\r\nVue.prototype.$store = store\r\nVue.prototype.$util = util\r\n\r\n\r\nVue.config.productionTip = false\r\n\r\nApp.mpType = 'app'\r\n\r\nconst app = new Vue({\r\n    ...App\r\n})\r\napp.$mount()","import mod from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=style&index=0&lang=css&\"","var render, staticRenderFns, recyclableRender, components\nvar renderjs\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"E:/yisheng/trunk/App.vue\"\nexport default component.exports","import mod from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\soft\\\\HBuilderX.2.4.2.20191115.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./App.vue?vue&type=script&lang=js&\"","\n    \n    let msgStorage = require(\"./components/easemob/comps/chat/msgstorage\");\n    let msgType = require(\"./components/easemob/comps/chat/msgtype\");\n    let disp = require(\"./components/easemob/utils/broadcast\");\n    \n    const emedia = wx.emedia = require(\"./components/easemob/emedia/emedia_for_miniProgram\") \n    \n    let WxIM = require(\"./components/easemob/utils/WebIM\")[\"default\"];\n    \n    import api from 'common/api.js';\n    \n\texport default {\n        globalData: {  \n            pageUrl: null  ,\n\t\t\tscene: '',\n            showIndex:false,\n            param:'',\n            testCode:''\n        },\n\t\tonLaunch: function(options) {\n\t\t\tconsole.log('App Launch:',options)\n            this.globalData.param = options.query\n            \n            this.globalData.scene = decodeURIComponent(options.scene)\n            \n            this.$im.conn.listen({\n            \tonOpened: (message)=>{\n            \t\t// this.$im.conn.setPresence();\n            \t\tconsole.log('登录成功登录成功');\n            \t\t\n            \t},\n            \tonReconnect: ()=>{\n            \t\t// this.$helper.toast('loading', '重连中...', 2000)\n            \t},\n            \tonSocketConnected: ()=>{\n            \t\t// this.$helper.toast('success', '登陆成功', 2000)\n            \t},\n            \tonClosed: ()=>{\n            \t\t\n                    var userinfo = uni.getStorageSync('userinfo')\n                    this.emchatLogin(userinfo.userId);\n            \t\t\n            \t},\n                \n            \tonInviteMessage: (message)=>{\n            \t\tthis.$options.globalData.saveGroupInvitedList.push(message);\n            \t\tdisp.fire(\"em.xmpp.invite.joingroup\", message);\n            \n            \t},\n            \tonPresence: (message)=>{\n            \t\t\n            \t},\n            \n            \tonRoster: (message)=>{\n            \t\t// let pages = getCurrentPages();\n            \t\t// if(pages[0]){\n            \t\t// \tpages[0].onShow();\n            \t\t// }\n            \t},\n            \n            \tonVideoMessage: (message)=>{\n            \t\tconsole.log(\"onVideoMessage: \", message);\n            \t\tif(message){\n            \t\t\tmsgStorage.saveReceiveMsg(message, msgType.VIDEO);\n            \t\t}\n          \n            \t},\n            \n            \tonAudioMessage: (message)=>{\n            \t\tconsole.log(\"onAudioMessage\", message);\n            \t\tif(message){\n            \t\t\tif(this.onMessageError(message)){\n            \t\t\t\tmsgStorage.saveReceiveMsg(message, msgType.AUDIO);\n            \t\t\t}\n            \t\t\n            \t\t}\n            \t},\n            \t\n            \tonCmdMessage: (message)=>{\n            \t\tconsole.log(\"onCmdMessage\", message);\n            \t\tif(message){\n            \t\t\tif(this.onMessageError(message)){\n            \t\t\t\tmsgStorage.saveReceiveMsg(message, msgType.CMD);\n            \t\t\t}\n          \n            \t\t}\n            \t},\n            \n            \tonTextMessage: (message)=>{\n            \t\tconsole.log(\"onTextMessage\", message);\n            \t\tif(message){\n            \t\t\tif(this.onMessageError(message)){\n            \t\t\t\tmsgStorage.saveReceiveMsg(message, msgType.TEXT);\n            \t\t\t}\n            \t\n            \t\t}\n            \t},\n            \n            \tonEmojiMessage: (message)=>{\n            \t\tconsole.log(\"onEmojiMessage\", message);\n            \t\tif(message){\n            \t\t\tif(this.onMessageError(message)){\n            \t\t\t\tmsgStorage.saveReceiveMsg(message, msgType.EMOJI);\n            \t\t\t}\n            \t\n            \t\t}\n            \t},\n            \tonPictureMessage: (message)=>{\n            \t\tconsole.log(\"onPictureMessage\", message);\n            \t\tif(message){\n            \t\t\tif(this.onMessageError(message)){\n            \t\t\t\tmsgStorage.saveReceiveMsg(message, msgType.IMAGE);\n            \t\t\t}\n            \t\t\n            \t\t}\n            \t},\n            \tonFileMessage: (message)=>{\n            \t\tconsole.log('onFileMessage', message);\n            \t\tif (message) {\n            \t\t\tif(this.onMessageError(message)){\n            \t\t\t\tmsgStorage.saveReceiveMsg(message, msgType.FILE);\n            \t\t\t}\n            \t\t}\n            \t},\n            \t// 各种异常\n            \tonError: (error)=>{\n            \t\tconsole.log(error)\n            \t\t// 16: server-side close the websocket connection\n            \t\tif(error.type == this.$im.statusCode.WEBIM_CONNCTION_DISCONNECTED ){\n            \t\t\tif(this.$im.conn.autoReconnectNumTotal < this.$im.conn.autoReconnectNumMax){\n            \t\t\t\treturn;\n            \t\t\t}\n            \t\t\tuni.showToast({\n            \t\t\t\ttitle: \"server-side close the websocket connection\",\n            \t\t\t\tduration: 1000\n            \t\t\t});\n            \t\t\n            \t\t\treturn;\n            \t\t}\n            \t\t// 8: offline by multi login\n            \t\tif(error.type == this.$im.statusCode.WEBIM_CONNCTION_SERVER_ERROR){\n            \t\t\t\n            \t\t\tvar userinfo = uni.getStorageSync('userinfo')\n            \t\t\t// this.emchatLogin(userinfo.userId);\n            \t\t}\n            \t\tif(error.type ==  this.$im.statusCode.WEBIM_CONNCTION_OPEN_ERROR){\n            \n            \t\t\t\n            \t\t}\n            \t\tif (error.type == this.$im.statusCode.WEBIM_CONNCTION_AUTH_ERROR) {\n            \t\t\tdisp.fire(\"em.xmpp.error.tokenErr\");\n            \t\t}\n            \t\tif (error.type == 'socket_error') {///sendMsgError\n            \t\t\tconsole.log('socket_errorsocket_error', error)\n            \t\t\tuni.showToast({\n            \t\t\t\ttitle: \"网络已断开\",\n            \t\t\t\ticon: 'none',\n            \t\t\t\tduration: 2000\n            \t\t\t});\n            \t\t}\n            \t},\n            });\n            \n            //以下界面不拦截\n            const uncheckedPath = ['__plugin__/wx2b03c6e691cd7370/pages/live-player-plugin','pages/housekeeper-sharing-img/housekeeper-sharing-img', 'pages/housekeeper-sharing-video/housekeeper-sharing-video', 'pages/liveborad/share', 'pages/health-product-detail/health-product-detail']\n            var action = true\n            if(options.path){\n\t\t\t\tlet checkPath = !uncheckedPath.find(path => options.path.indexOf(path) > -1) \n                if(options.path && (options.path.search('index/auth') != -1 || !checkPath) ){\n                    action = false\n                    this.globalData.showIndex = true\n                    if(options.path == 'pages/health-product-detail/health-product-detail'){\n                        this.globalData.pageUrl = options.path\n                    }\n                }\n            }\n            \n            console.log('options.path:',options.path)\n            if(action){\n                console.log('options.path:',options.path)\n                this.globalData.pageUrl = options.path\n                var _self = this\n                uni.checkSession({\n                    success() {\n                        // session_key 未过期，并且在本生命周期一直有效\n                        console.log(\"未过期\");\n                        _self.wxlogin()\n                            \n                    },\n                    fail() {\n                        console.log(\"过期\");\n                        _self.wxlogin()\n                    }\n                })\n            }\n\t\t},\n\t\tonShow: function(options) {\n\t\t\tconsole.log('App Show')\n            if (options.scene == 1007 || options.scene == 1008 || options.scene == 1044) {\n                let livePlayer = requirePlugin('live-player-plugin')\n                livePlayer.getShareParams()\n                    .then(res => {\n                        // 房间号\n                        console.log('get room id', res.room_id) \n                        // 用户openid\n                        console.log('get openid', res.openid) \n                        // 分享者openid，分享卡片进入场景才有\n                        console.log('get share openid', res.share_openid) \n                        // 开发者在跳转进入直播间页面时，页面路径上携带的自定义参数，这里传回给开发者\n                        console.log('get custom params', res.custom_params) \n                        this.globalData.scene = res.custom_params.communityId\n                    }).catch(err => {\n                        console.log('get share params', err)\n                    })\n            }\n\t\t},\n\t\tonHide: function() {\n\t\t\tconsole.log('App Hide')\n\t\t},\n        methods: {\n            wxlogin:function(){\n                var _self = this\n                uni.login({\n                    provider: 'weixin',\n                    success: function(loginRes) {\n                        console.log(loginRes)\n                        const obj = {\n                            code: loginRes.code\n                        }\n                        api.getUnionid({\n                            data: obj\n                        }).then(res => {\n                            console.log(res)\n                            console.log('sk:' + res.data.session_key)\n                            uni.setStorageSync('sk', res.data.session_key);\n                            uni.setStorageSync('openid', res.data.openid);\n                            uni.setStorageSync('unionid', res.data.unionid);\n                            _self.checkAuth()\n                        })\n                    }\n                });\n            },\n            checkAuth: function() {\n                var _self = this\n                uni.getUserInfo({\n                    success(res) { //已经授权请求是否绑定信息\n                        console.log(\"getUserInfo:\",res)\n                        _self.getAccount(res)\n                    },\n                    fail(res) { //没有授权直接跳转登录\n                        console.log(\"没有授权\")\n                        _self.globalData.pageUrl = '../index/index'\n                        uni.reLaunch({\n                            url:\"/pages/index/auth\"\n                        })\n                    }\n                })\n            },\n            getAccount: function(res) {\n                const sessionKey = uni.getStorageSync('sk');\n                // console.log(\"res.iv:\")\n                // console.log(res.iv)\n                if(!sessionKey){\n                    const unionid = uni.getStorageSync('unionid');\n                    if(unionid){\n                        api.getTempAccount({\n                            data: {\n                                code: unionid\n                            }\n                        }).then(aes => {\n                            console.log(aes)\n                            if (aes.status == 'OK') {\n                                uni.setStorageSync('sessionId', aes.data.sessionId)\n                                this.findUser(userRes.data.id)\n                            }\n                        })\n                    }\n                    \n                }\n               \n                var communityId = ''\n                \n                if(this.globalData.param['communityId']){\n                    \n                    communityId = this.globalData.param['communityId']\n                }else if(this.globalData.scene){\n                    communityId = this.globalData.scene\n                }\n                console.log(\"communityId:\",communityId)\n                const data = {\n                    encryptedData: res.encryptedData,\n                    iv: res.iv,\n                    sessionKey: sessionKey,\n\t\t\t\t\tcommunityId:communityId\n                }\n                var _self = this\n                api.getAccountInfo({\n                    data: data\n                }).then(accountRes => {\n                    console.log(\"accountRes:\")\n                    console.log(accountRes)\n                    if (!accountRes.data.bnUserInfo) {\n                        uni.removeStorageSync('sk');\n                        const unionid = uni.getStorageSync('unionid');\n                        if(unionid){\n                            api.getTempAccount({\n                                data: {\n                                    code: unionid\n                                }\n                            }).then(aes => {\n                                console.log(aes)\n                                if (aes.status == 'OK') {\n                                    uni.setStorageSync('sessionId', aes.data.sessionId)\n                                    _self.findUser(userRes.data.id)\n                                }\n                            })\n                        }\n                        return;\n                    }\n                    if(accountRes.data.wxUserInfo && accountRes.data.wxUserInfo.unionid ){\n                        uni.setStorageSync('unionid', accountRes.data.wxUserInfo.unionid);\n                    }\n                    if(accountRes.data.bnUserInfo && accountRes.data.bnUserInfo.sessionId ){\n                        const sessionId = accountRes.data.bnUserInfo.sessionId\n                        uni.setStorageSync('sessionId', sessionId)\n                    }\n                    if (accountRes.data.bnUserInfo.phone == \"\" || accountRes.data.bnUserInfo.phone == null) { //未绑定\n                        uni.reLaunch({\n                            url:'/pages/index/auth?type=2'\n                        })\n                    }else{\n                        // uni.reLaunch({\n                        //     url:'/pages/index/auth?type=2'\n                        // })\n                        this.findUser(accountRes.data.bnUserInfo.id,accountRes.data.bnUserInfo.avatarPath);\n                    }\n                })\n            },\n            findUser:function(id,avatarPath){\n                const userObj = {userId: id};\n                api.findUserById({\n                    data:userObj\n                }).then(userRes => {\n                    if(userRes.status == 'OK'){\n                        var userInfo = userRes.data;\n                        userInfo.avatarPath = avatarPath;\n                        uni.setStorageSync('userinfo', userInfo);\n                        this.emchatLogin(id);\n                        // this.getCurrentRoute()\n                        uni.showToast({\n                            title: '登录成功',\n                        })\n                        if(this.globalData.pageUrl && this.globalData.pageUrl.search('index/index') == -1){\n                            //是否有指定路径\n                            console.log(this.globalData.pageUrl)\n                            var qu = ''\n                            var index = 0\n                            for(var key in getApp().globalData.param){\n                            \tconsole.log(key+\":\"+this.globalData.param[key]);//json对象中属性的名字：对象中属性的值\n                                if(index==0){\n                                    qu = qu + '?' +key + '=' + getApp().globalData.param[key]\n                                }else{\n                                    qu = qu + '&'+ key + '=' + getApp().globalData.param[key]\n                                }\n                                \n                                index++\n                            }\n                            console.log(this.getCurrentRoute() != this.globalData.pageUrl)\n                            if(this.getCurrentRoute() != this.globalData.pageUrl){\n                                uni.navigateTo({\n                                    url:'/'+this.globalData.pageUrl + qu\n                                });\n                            }\n                        }else{\n                            //没有跳转index或者加入服务站\n                            console.log(userRes.data.followCommunityId)\n                            if( userRes.data && userRes.data.followCommunityId && userRes.data.followCommunityId.length > 3 ){\n                                this.globalData.showIndex = true\n                                uni.reLaunch({\n                                    url:'/pages/index/index?communityid='+userRes.data.followCommunityId\n                                });\n                            }else{\n                                uni.navigateTo({\n                                    url:'/pages/serverStation/main'\n                                });\n                            }\n                        }\n                    }\n                });\n            },\n            emchatLogin:function(userid){\n                var pwd = userid.substring(1,userid.length-1);\n                if(this.$conn){\n                    this.$conn.open({\n                    \tapiUrl: this.$im.config.apiURL,\n                    \tuser: userid,\n                    \tpwd: pwd,\n                    \tgrant_type: \"password\",\n                    \tappKey: this.$im.config.appkey\n                    });\n                }else{\n                    var obj = {\n                        \tapiUrl: 'https://a1.easemob.com',\n                            user: userid,\n                            pwd: pwd,\n                        \tgrant_type: \"password\",\n                        \tappKey: '1184170206115288#mingwo'\n                        }\n                    WxIM.conn.open(obj);\n                }\n            },\n            getCurrentRoute(){\n                let pages = getCurrentPages();\n            \tlet currentPage = pages[pages.length - 1];\n                console.log(currentPage)\n            \treturn currentPage.route;\n            },            \n            onMessage: function(){\n                console.log('onMessageonMessageonMessage')\n            },\n            onMessageError(err){\n            \tif(err.type === \"error\"){\n            \t\tuni.showToast({\n            \t\t\ttitle: err.errorText\n            \t\t});\n            \t\treturn false;\n            \t}\n            \treturn true;\n            }\n        }\n\t}\n"],"sourceRoot":""}